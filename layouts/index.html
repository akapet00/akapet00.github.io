{{ define "main" }}
<article class="home">
  {{/* Intro */}}
  <section class="home-intro fade-in">
    {{ .Content }}
  </section>

  {{/* Experience Timeline */}}
  {{ with .Params.experience }}
  <section class="home-section fade-in">
    <div class="section-header">
      <h2>Experience</h2>
      <a href="{{ "about/" | relURL }}" class="view-all">View all →</a>
    </div>
    <div class="timeline">
      {{ range . }}
      <div class="timeline-item">
        <div class="timeline-date">{{ .years }}</div>
        <div class="timeline-content">
          <div class="timeline-title">{{ .title }}</div>
          <div class="timeline-org">{{ with .org_url }}<a href="{{ . }}" target="_blank" rel="noopener">{{ end }}{{ .org }}{{ with .org_url }}</a>{{ end }}</div>
          {{ with .desc }}<div class="timeline-desc">{{ . }}</div>{{ end }}
        </div>
      </div>
      {{ end }}
    </div>
  </section>
  {{ end }}

  {{/* Recent Writing */}}
  {{ $posts := where .Site.RegularPages "Section" "blog" }}
  {{ $posts = $posts | first 3 }}
  {{ if $posts }}
  <section class="home-section fade-in">
    <div class="section-header">
      <h2>Recent Writing</h2>
      <a href="{{ "blog/" | relURL }}" class="view-all">View all →</a>
    </div>
    <div class="post-cards">
      {{ range $posts }}
      <a href="{{ .RelPermalink }}" class="post-card">
        <span class="post-card-date">{{ .Date.Format "Jan 2006" }}</span>
        <span class="post-card-title">{{ .Title }}</span>
      </a>
      {{ end }}
    </div>
  </section>
  {{ end }}

  {{/* Projects */}}
  {{ $projects := where .Site.RegularPages "Section" "projects" }}
  {{ $projects = $projects | first 3 }}
  {{ if $projects }}
  <section class="home-section fade-in">
    <div class="section-header">
      <h2>Projects</h2>
      <a href="{{ "projects/" | relURL }}" class="view-all">View all →</a>
    </div>
    <div class="project-cards">
      {{ range $projects }}
      <a href="{{ .RelPermalink }}" class="project-card">
        <span class="project-card-title">{{ .Title }}</span>
        {{ with .Description }}<span class="project-card-desc">{{ . }}</span>{{ end }}
      </a>
      {{ end }}
    </div>
  </section>
  {{ end }}

  {{/* Selected Publications */}}
  {{ $pubs := site.Data.publications }}
  {{ if $pubs }}
  {{ $pubs = $pubs | first 3 }}
  <section class="home-section fade-in">
    <div class="section-header">
      <h2>Selected Publications</h2>
      <a href="{{ "publications/" | relURL }}" class="view-all">View all →</a>
    </div>
    <div class="pub-cards">
      {{ range $pubs }}
      <div class="pub-card">
        <span class="pub-card-title">{{ .title }}</span>
        <span class="pub-card-venue">{{ .venue }}, {{ .year }}</span>
      </div>
      {{ end }}
    </div>
  </section>
  {{ end }}

</article>

{{ end }}
